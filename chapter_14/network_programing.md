# 网络编程

Python是一个很强大的网络编程工具：
* Python内有很多针对常见网络协议的库，对网络协议的各个层次进行了抽象封装。
* Python非常善于处理字节流的各个模式，使用Python可以很容易地写出处理各种协议格式的代码。

## 少数几个网络设计模块

### socket模块

在网络编程中的一个基本组件就是套接字(socket)。套接字基本上是两个端点的程序之间的“信息通道”。程序可能分布在不同的计算机上（通过网络连接），通过套接字相互发送信息。在Python中的大多数的网络编程都隐藏了socket模块的基本细节，不直接和套接字交互。

套接字包括两个：服务器套截止和客户机套接字。在创建一个服务器套接字后，让它等待连接。这样它就在某个网络地址处（IP地址和一个端口号的组合）监听，直到有客户端套接字连接。连接完成后，两者就可以进行交互了。

处理客户端套接字通常比处理服务器端套接字容易，因为服务器必须准备随时处理客户端的链接，同时还要处理多个链接，而客户机只是简单地链接，完成事务，断开链接。

一个套接字就是socket模块中的socket类的一个实例。它的实例化需要三个参数:第一个参数是地址族（默认是socket.AF_INET）；第二个参数是流（socket.SOCK_STREAM，默认值）或数据包（socket.SOCK_DGRAM）套接字；第三个参数是使用的协议（默认是0，使用默认值即可）。对于一个普通的套接字，不需要提供任何参数。

服务器端套接字使用bind方法后，在调用listen方法去监听某个特定的地址。客户端套接字使用connect方法连接到服务器，在connect方法中使用的地址与服务器在bind方法中的地址相同（在服务器端，能实现很多功能，比如使用函数socket.gethostname得到当前主机名）。在这种情况下，一个地址就是一个格式为(host,post)的元组，其中host是主机名（比如www.example.com），port是端口号（一个整数）。listen方法只有一个参数，即服务器未处理的连接的长度（即允许排队等待的连接数目，这些连接在禁用之前等待）。

服务器端套接字开始监听后，它就可以接受客户端的链接。这个步骤使用accept方法来完成。这个方法会阻塞（等待）直到客户端连接，然后该方法就返回一个格式为（client，address）的远足，client是一个客户端套接字，address是一个前面解释过的地址。服务器在处理完与该客户端的链接后，再次调用accept方法开始等待下一个链接。这个过程通常都是在一个无线循环中实现的。

注意：这种形式的服务器端编程为阻塞或者是同步网络编程。

套接字有两个方法，send和recv（用于接收），用于传输数据。可以使用字符串参数调用send以发送数据，用一个所需的（最大）字节数做参数调用recv来接收数据。如果不能确定使用哪个数字比较好，那么1024是个很好的选择。

[simple_server]()和[simple_client]()展示了一个最简单的客户机/服务器程序。如果在同一台机器上运行它们（先启动服务），服务器会打印出发现的一个连接的信息。然后客户端打印从服务端收到的信息。可以在服务器运行同时运行多个客户机。通过用服务器端所在机器的实际主机名来代替客户端调用gethostname所得到的主机名，就可以让两个运行在不同机器上的程序通过网络连接起来。

### urllib 和 urllib2模块

在能使用的各种网络函数库中，功能最强大的可能是urllib和urllib2.通过它们在网络上访问文件，就好像访问本地电脑上的文件一样。通过一个简单的函数调用，几乎可以把任何URl所指向的东西用做程序的输入。使用这两个模块与re，模块结合使用：可以下载web页面，提取信息，以及自动生成报告等。
